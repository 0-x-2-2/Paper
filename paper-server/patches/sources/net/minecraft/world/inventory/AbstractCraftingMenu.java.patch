--- a/net/minecraft/world/inventory/AbstractCraftingMenu.java
+++ b/net/minecraft/world/inventory/AbstractCraftingMenu.java
@@ -13,14 +13,17 @@
 
     private final int width;
     private final int height;
-    public final CraftingContainer craftSlots;
+    public final TransientCraftingContainer craftSlots; // CraftBukkit
     public final ResultContainer resultSlots = new ResultContainer();
 
-    public AbstractCraftingMenu(MenuType<?> type, int syncId, int width, int height) {
-        super(type, syncId);
-        this.width = width;
-        this.height = height;
-        this.craftSlots = new TransientCraftingContainer(this, width, height);
+    public AbstractCraftingMenu(MenuType<?> containers, int i, int j, int k, Inventory playerInventory) { // CraftBukkit
+        super(containers, i);
+        this.width = j;
+        this.height = k;
+        // CraftBukkit start
+        this.craftSlots = new TransientCraftingContainer(this, j, k, playerInventory.player); // CraftBukkit - pass player
+        this.craftSlots.resultInventory = this.resultSlots; // CraftBukkit - let InventoryCrafting know about its result slot
+        // CraftBukkit end
     }
 
     protected Slot addResultSlot(Player player, int x, int y) {
@@ -38,7 +41,7 @@
 
     @Override
     public RecipeBookMenu.PostPlaceAction handlePlacement(boolean craftAll, boolean creative, RecipeHolder<?> recipe, ServerLevel world, Inventory inventory) {
-        RecipeHolder<CraftingRecipe> recipeholder1 = recipe;
+        RecipeHolder<CraftingRecipe> recipeholder1 = (RecipeHolder<CraftingRecipe>) recipe; // CraftBukkit - decompile error
 
         this.beginPlacingRecipe();
 
@@ -65,7 +68,7 @@
                 }
             }, this.width, this.height, list, list, inventory, recipeholder1, craftAll, creative);
         } finally {
-            this.finishPlacingRecipe(world, recipe);
+            this.finishPlacingRecipe(world, recipeholder1); // CraftBukkit - decompile error
         }
 
         return containerrecipebook_a;
