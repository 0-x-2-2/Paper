From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Fri, 28 Nov 2014 13:12:00 -0600
Subject: [PATCH] Improve Network Manager packet handling

Removes an unnecessary "peek at head of queue"

diff --git a/src/main/java/net/minecraft/server/NetworkManager.java b/src/main/java/net/minecraft/server/NetworkManager.java
index 0000000000000000000000000000000000000000..0000000000000000000000000000000000000000 100644
--- a/src/main/java/net/minecraft/server/NetworkManager.java
+++ b/src/main/java/net/minecraft/server/NetworkManager.java
@@ -0,0 +0,0 @@ public class NetworkManager extends SimpleChannelInboundHandler {
 
     private void m() {
         if (this.i != null && this.i.isOpen()) {
-            while (!this.h.isEmpty()) {
-                QueuedPacket queuedpacket = (QueuedPacket) this.h.poll();
-
+            // PaperSpigot  start - Improve Network Manager packet handling
+            QueuedPacket queuedpacket;
+            while ((queuedpacket = (QueuedPacket) this.h.poll()) != null) {
+                // PaperSpigot end
                 this.a(QueuedPacket.a(queuedpacket), QueuedPacket.b(queuedpacket));
             }
 
--